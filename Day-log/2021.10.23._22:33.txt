오늘은 굉장히 많은 걸 했다..
뭘 했는지 기억이 안 날 정도로 말이다.
내일 폰을 받으면 방문 기록부터 확인해 봐야겠다.

일단 기억나는 것만 정리해 보겠다.
엠갤이 정상적으로 작동하지 않는 걸 보고 내 서버에서 아카이브를 돌리면 어떨까 하는 생각이 들었다.
pi에서 돌아가고 있는 DGK를 조금만 변형시키면 아카이브(크롤러) 프로그램이 되기 때문이다.

소스 코드를 조금 손봐서 Archive Mode를 추가했고, 정상 작동을 확인한 후에 그것을 tmux 위에 실행하고 pane을 나누어 아래에는 watch -n1 ls -lt를 실행하여 수집되는 페이지들을 갱신되게 해 놓았다. 

얼마전 python3 -m http.server로 간단하게 돌리고 있었던 웹 서버로는 내가 생각하는 것을 제대로 만들기 어려울 것 같아 본격적인 웹 서버 프로그램인 Apache2.4를 재구성하였다.
config 파일을 둘러보고, 서비스를 활성화하고 포트포워딩하고, 아무튼 그리 길지 않은 삽질 끝에 테스트페이지를 띄우는 데 성공했다.

그리고 이것을 게시판에 올려야 하는데, 내 IP가 그대로 노출되는 것은 아무래도 좋지 않기에 다른 IP를 노출시킬 필요가 있었다.
그 대상으로 가장 먼저 생각난 것이 구름IDE의 가상머신이었다.

scp로 소스파일과 gotty 등등 필요한 것들을 복사한 뒤 같은 환경을 만들어 실행하자, 내가 생각한 대로 완벽하게 돌아갔다.
구름IDE에서 포트포워딩도 지원하기에 8000, 8081 포트를 각각 바인딩하여 게시판에 올릴 수 있었다.

문제는 구름IDE에서 컨테이너를 조작하지 않은 상태로 일정 시간이 지나면 자동으로 컨테이너가 종료된다는 것이다.
이걸 해결하려면 24시간 켜두기라는 옵션을 구매해야 하는데, 이게 꽤나 비싸서 이걸 살 바에는 차라리 내가 직접 만드는 게 낫다고 생각했다.

Codeanyware도 구름IDE와 마찬가지여서 들어간 김에 회원탈퇴했다.

그럼 어떻게 하느냐.. 호스팅kr에서 웹 호스팅 서비스를 하는 것이 생각나 소액을 지불하고 서비스를 구매했는데, cPanel에서 이것저것 만져봐도 내가 생각하는 그게 아니어서 1~2시간 삽질하다 환불했다.

웹 호스팅은 아닌 것 같아서 다른 것을 찾아봤는데, VPS 호스팅, 서버 호스팅, 클라우드 등 여러가지 방법이 있었다.
그러나 결국 내가 선택한 방법은 도메인만을 구매하여 내 서버에서 직접 돌리는 것이었다.
내 서버에서 직접 돌리되 도메인으로 IP가 직접 노출되는 것을 가리고, 보안 옵션을 추가해 nslookup이나 whois 등으로 조회했을 때 개인정보가 노출되지 않도록 하는 것이다.

도메인은 호스팅kr에서 샀지만, 엠갤의 namecheap.com도 괜찮은 것 같다.
도메인 설정 창에서 이것저것 처음 보는 개념들을 익히느라 시간을 꽤 썼다.
그러나 지금 다시 보면 어려울 것은 별로 없다.

그러나 whois에서 도메인을 조회했을 때 호스팅kr에서 입력한 도메인 소유자 정보가 그대로 노출되는 것을 확인할 수 있었는데, 이를 막기 위해 알아본 결과 Cloudflare를 사용하면 해결할 수 있는 듯했다. (나중에서야 알았지만, Cloudflare를 사용해서 얻은 것은 사이트 운영에 유용한 보안/최적화 옵션들과 nslookup으로 dns를 조회했을 때 서버IP가 바로 노출되는 것을 막아주는 것 정도였다)

Cloudflare에 가입하려 하는데, KKG의 구글 계정이 너무 충동적으로 지어진 것 같다는 생각이 들어 clndr로 바꾸어야 하나 하고 수시간 시간만 버렸다.
물론 clndr라 바꿀 수야 있겠지만 KKG로 벌여놓은 것이 너무 많아 이전하기가 어려운 점 등등 여러가지 문제로 인해 결국 계속 KKG 계정을 사용하기로 결정했다.

Cloudflare에 가입 후 도메인을 입력했지만 내가 원하는 결과가 나오지 않았다. 
원인을 곰곰이 생각해봤는데, 당장 브라우저 주소창에 도메인을 입력하고 접속해도 내 서버로 연결되지 않았다.

원인은 호스팅kr에서 DNS레코드가 제대로 적용되지 않아서 그런 것이었다.

모바일 버전의 호스팅kr 사이트에서 DNS레코드를 설정을 수십번 하여도 적용이 되지 않아 혹시나 해서 PC버전으로 해봤는데 바로 되어 어이가 없었다.
A Record 방식으로 내 서버 IP로 연결하니 도메인을 입력했을 때 내 서버로 접속이 되는 것을 확인할 수 있었다.

정상 작동을 확인한 후 클플에서 조회 후 등록을 마쳤다.
등록하는 과정에서 네임서버, 레코드에 관한 지식을 정리하는 시간을 가질 수 있었다.

좋다. 가끔 삽질을 하루 이틀을 넘게 하는 경우도 있는데 이정도면 삽질을 거의 하지 않고 목적을 이룬 것이라 기분이 좋다.

클플에 등록 후 도메인을 통해 사이트에 접속하면 나무위키 등 클플을 이용하는 사이트에 접속할 때와 같은 DDOS 확인 화면을 볼 수 있었다.

nslookup으로 도메인을 조회해도 클플의 IP 주소가 표시되었다.
남은 것은 whois로 조회했을 때 도메인 소유자의 정보가 그대로 노출된다는 것인데..

이것은 호스팅kr에서의 보안옵션 추가로 해결할 수 있다.
다만 지금 휴대폰이 없어서 결제를 할 수가 없다.
내일 폰 받으면 보안옵션 추가부터 해야겠다.

기억나는 키워드: clowndora, hamisien, 아파치 로그파일, myactivity.google.com, 톰캣, apache/tomcat 차이, 아파치 가상호스트로 포트별 사이트 운영

추가 정보 → 아파치 웹서버를 설치한 이유는 파이썬 http.server 모듈로 웹 서버를 기동했을 때 Directory listing 페이지에서 날짜별 정렬이 되지 않았기 때문이다.
